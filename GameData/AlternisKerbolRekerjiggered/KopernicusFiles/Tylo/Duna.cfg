// Apply this patch after the Kopernicus mod is loaded
@Kopernicus:FOR[AlternisKerbol]
{
    // We want to make Duna orbit Tylo
    @Body[Duna]
    {
		
		cacheFile = AlternisKerbolRekerjiggered/Cache/Duna.bin
		@Properties
		{
			tidallyLocked = true
			description = Duna is a small, butterscotch-colored moon orbiting Tylo, and was the first moon discovered orbiting a planet other than Jool. This discovery was vital to prove that Jool was not the center of the universe because after all, if something was going around Tylo, it wasn't going around Jool. Its brown-yellow color is thought to be due to a sandy, nutrient-poor soil covering. Its tenuous atmosphere is likely heavy in carbon dioxide and nitrogen, and very thin. Duna has some small dry-ice and water ice caps, which may hold the potential for simple forms of life. Comparing to Laythe's lush environment and contrasting with Eve's toxic atmosphere, Duna is thought to be the third best planet in the Solar System for supporting life. For this reason, Duna has long been a wonder to Kerbalkind.
		}
		Debug
		{
			update = true
			exportBin = true
		}
		@Template
		{
			removePQSMods = VertexColorMapBlend,PQSLandControl,VertexSimplexNoiseColor,VertexHeightNoiseVertHeightCurve2,VertexHeightNoiseVertHeightCurve2,VertexHeightNoiseVertHeightCurve2,VertexSimplexHeightAbsolute
		}
		@Atmosphere
        {
            // effectively the ambient lighting color for all objects on the ground of this body (provides a slight tint)
            ambientColor = 0.096,0.045,0,1
			waveLength = 0.2058824,0.187128,0.1347621,1
        } 
		@ScaledVersion
		{
			Material
			{
				texture = AlternisKerbolRekerjiggered/PluginData/Duna_Color.png
				normals = AlternisKerbolRekerjiggered/PluginData/Duna_Normal.png
				rimColorRamp = AlternisKerbolRekerjiggered/Textures/ramp_Duna
			}
		}
		
		@PQS
		{
			Material
            {
                saturation = 0.8
                contrast = 3.1
                tintColor = 0.173,0.173,0.173,0.482
				
                powerNear = 0.7
                powerFar = 0.4

                groundTexStart = 0
                groundTexEnd = 2000

                steepPower = 3
                steepTexStart = 0
                steepTexEnd = 500000
                steepTex = BUILTIN/terrain_sand00
                steepBumpMap = BUILTIN/Cliff (Layered Rock)_NRM
                steepNearTiling = 400
                steepTiling = 500

                lowTex = BUILTIN/terrain_sand00
                lowBumpMap = BUILTIN/05_NORMAL
                lowNearTiling = 15000
                lowMultiFactor = 10
                lowBumpNearTiling = 2000
                lowBumpFarTiling = 5

                midTex = BUILTIN/terrain_sand00
                midBumpMap = BUILTIN/05_NORMAL
                midNearTiling = 15000
                midMultiFactor = 10
                midBumpNearTiling = 2000
                midBumpFarTiling = 5

                highTex = BUILTIN/terrain_sand00
                highBumpMap = BUILTIN/Waterbump
                highNearTiling = 15000
                highMultiFactor = 10
                highBumpNearTiling = 2000
                highBumpFarTiling = 5

                lowStart = 0
                lowEnd = 0.3
                highStart = 0.8
                highEnd = 1

                globalDensity = 0
                fogColorRamp = BUILTIN/AerialRampKerbin
            }
			Mods
			{
				VertexColorMap
				{
					map = AlternisKerbolRekerjiggered/PluginData/Duna_Color.png
					enabled	= true
				}
				VertexHeightMap
				{
					map = AlternisKerbolRekerjiggered/PluginData/Duna_Height.png
					deformity = 11000
					enabled = true
				}
				VertexHeightNoiseVertHeight
				{
					name = VHNVH-1
					noiseType = RiggedMultifractal
					deformity = 1700
					seed = 347565
					frequency = 18
					lacunarity = 1.5
					persistance = 0.7
					octaves = 6
					mode = Low
					heightStart = 0.2
					heightEnd = 1
					order = 20
				}
				VertexSimplexHeightAbsolute
				{
					name = VSHA-1
					seed = 98580
					deformity = 200
					octaves = 8
					persistence = 0.6
					frequency = 24
					order = 22
				}
				VertexSimplexHeightAbsolute
				{
					name = VSHA-2
					seed = 8958758
					deformity = 500
					octaves = 4
					persistence = 0.6
					frequency = 16
					order = 9999993
				}
				VertexHeightNoiseVertHeight
				{
					name = VHNVH-2
					noiseType = RiggedMultifractal
					deformity = 40
					seed = 42634
					frequency = 320
					lacunarity = 1.5
					persistance = 0.7
					octaves = 4
					mode = Low
					heightStart = 0.2
					heightEnd = 1
					order = 20
					
				}
			}
		}
		@Orbit
		{
			@referenceBody = Tylo
			semiMajorAxis = 34598850
			inclination	= 0.7
			eccentricity = 0.05
			longitudeOfAscendingNode = 135.5
			argumentOfPeriapsis	= 0
			meanAnomalyAtEpoch = 3.14
			epoch = 0
			color = RGBA(255, 185, 123, 255)
		}
    }
}

@Kopernicus:FOR[AlternisKerbol]:NEEDS[GalacticNeighborhood]
{
	@Body[Duna]
	{
		@Properties
		{
			%description = Egar is a medium-sized moon orbiting Stumbos. It is colored a nice butterscotch color. It may very well hold life on its surface somewhere, because there's definitely some canalis. Maybe. It looks decently canal-like for sure. Hard to tell at this distance.
		}
	}
}

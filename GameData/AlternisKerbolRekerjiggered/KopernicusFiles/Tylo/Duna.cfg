// Apply this patch after the Kopernicus mod is loaded
@Kopernicus:FOR[AlternisKerbol]
{
    // We want to make Duna orbit Tylo
    @Body[Duna]
    {
		
		cacheFile = AlternisKerbolRekerjiggered/Cache/Duna.bin
		@Properties
		{
			tidallyLocked = true
			description = Duna is a small, butterscotch-colored moon orbiting Tylo, and was the first moon discovered orbiting a planet other than Jool. This discovery was vital to prove that Jool was not the center of the universe because after all, if something was going around Tylo, it wasn't going around Jool. Its brown-yellow color is thought to be due to a sandy, nutrient-poor soil covering. Its tenuous atmosphere is likely heavy in carbon dioxide and nitrogen, and very thin. Duna has some small dry-ice and water ice caps, which may hold the potential for simple forms of life. Comparing to Laythe's lush environment and contrasting with Eve's toxic atmosphere, Duna is thought to be the third best planet in the Solar System for supporting life. For this reason, Duna has long been a wonder to Kerbalkind.
		}
		Debug
		{
			update = true
			exportBin = true
		}
		@Template
		{
			removePQSMods = VertexColorMapBlend,PQSLandControl,VertexSimplexNoiseColor,VertexHeightNoiseVertHeightCurve2,VertexHeightNoiseVertHeightCurve2,VertexHeightNoiseVertHeightCurve2,VertexSimplexHeightAbsolute
		}
		@Atmosphere
        {
            // effectively the ambient lighting color for all objects on the ground of this body (provides a slight tint)
            ambientColor = 0.096,0.045,0,1
			waveLength = 0.2058824,0.187128,0.1347621,1
        } 
		@ScaledVersion
		{
			Material
			{
				texture = AlternisKerbolRekerjiggered/PluginData/Duna_Color.png
				normals = AlternisKerbolRekerjiggered/PluginData/Duna_Normal.png
				rimColorRamp = AlternisKerbolRekerjiggered/Textures/ramp_Duna
			}
		}
		
		@PQS
		{
			Material
			{
				saturation = 1
				contrast = 2
				tintColor = 1,1,1,0
				powerNear = 0.58
				powerFar = 0.58
				groundTexStart = 0
				groundTexEnd = 1000
				steepPower = 2
				steepTexStart = 0
				steepTexEnd = 50000
				steepTex = BUILTIN/red_cliff
				steepTexScale = 1,1
				steepTexOffset = 0,0
				steepBumpMap = BUILTIN/RockyGround2
				steepBumpMapScale = 1,1
				steepBumpMapOffset = 0,0
				steepNearTiling = 4000
				steepTiling = 50
				lowTex = BUILTIN/RockyGround
				lowTexScale = 1,1
				lowTexOffset = 0,0
				lowBumpMap = BUILTIN/RockyGround2
				lowBumpMapScale = 1,1
				lowBumpMapOffset = 0,0
				lowNearTiling = 2000
				lowMultiFactor = 10
				lowBumpNearTiling = 2000
				lowBumpFarTiling = 10
				midTex = BUILTIN/RockyGround
				midTexScale = 1,1
				midTexOffset = 0,0
				midBumpMap = BUILTIN/RockyGround2
				midBumpMapScale = 1,1
				midBumpMapOffset = 0,0
				midNearTiling = 4000
				midMultiFactor = 10
				midBumpNearTiling = 8000
				midBumpFarTiling = 10
				highTex = BUILTIN/SandyGround
				highTexScale = 1,1
				highTexOffset = 0,0
				highBumpMap = BUILTIN/SandyGround
				highBumpMapScale = 1,1
				highBumpMapOffset = 0,0
				highNearTiling = 4000
				highMultiFactor = 10
				highBumpNearTiling = 4000
				highBumpFarTiling = 10
				lowStart = 0
				lowEnd = 0.3
				highStart = 0.8
				highEnd = 1
				globalDensity = -8E-06
				fogColorRamp = BUILTIN/desert_atmogradient
				fogColorRampScale = 1,1
				fogColorRampOffset = 0,0
				planetOpacity = 1
			}
			FallbackMaterial
			{
				saturation = 1
				contrast = 1.55
				tintColor = 1,1,1,0
				texTiling = 1000
				texPower = 0.3
				multiPower = 0.3
				groundTexStart = 20000
				groundTexEnd = 60000
				multiFactor = 0.5
				mainTex = BUILTIN/SandyGround
				mainTexScale = 1,1
				mainTexOffset = 0,0
				planetOpacity = 0
			}
			Mods
			{
				LandControl
				{
					altitudeBlend = 0
					altitudeFrequency = 1
					altitudeOctaves = 1
					altitudePersistance = 1
					altitudeSeed = 1
					createColors = False
					createScatter = True
					latitudeBlend = 0
					latitudeFrequency = 1
					latitudeOctaves = 1
					latitudePersistance = 1
					latitudeSeed = 1
					longitudeBlend = 0
					longitudeFrequency = 1
					longitudeOctaves = 1
					longitudePersistance = 1
					longitudeSeed = 1
					useHeightMap = False
					vHeightMax = 10000
					order = 999999
					enabled = True
					name = Scatter
					index = 0
					altitudeSimplex
					{
						frequency = 1
						octaves = 1
						persistence = 1
					}
					latitudeSimplex
					{
						frequency = 1
						octaves = 1
						persistence = 1
					}
					longitudeSimplex
					{
						frequency = 1
						octaves = 1
						persistence = 1
					}
					landClasses
					{
						Class
						{
							alterApparentHeight = 0
							alterRealHeight = 0
							color = 0,0,0,0
							coverageBlend = 0
							coverageFrequency = 1
							coverageOctaves = 1
							coveragePersistance = 1
							coverageSeed = 1
							name = Base
							latDelta = 1
							latitudeDouble = False
							lonDelta = 1
							minimumRealHeight = 0
							noiseBlend = 0
							noiseColor = 0,0,0,0
							noiseFrequency = 1
							noiseOctaves = 1
							noisePersistance = 1
							noiseSeed = 1
							delete = False
							altitudeRange
							{
								endEnd = 1
								endStart = 1
								startEnd = 0
								startStart = 0
							}
							coverageSimplex
							{
								frequency = 1
								octaves = 1
								persistence = 1
							}
							latitudeDoubleRange
							{
								endEnd = 1
								endStart = 1
								startEnd = 0
								startStart = 0
							}
							latitudeRange
							{
								endEnd = 1
								endStart = 1
								startEnd = 0
								startStart = 0
							}
							longitudeRange
							{
								endEnd = 2
								endStart = 2
								startEnd = -1
								startStart = -1
							}
							noiseSimplex
							{
								frequency = 1
								octaves = 1
								persistence = 1
							}
							scatters
							{
								Scatter
								{
									density = 1
									scatterName = Rock00
								}
							}
						}
					}
					scatters
					{
						Scatter
						{
							materialType = Diffuse
							mesh = BUILTIN/boulder
							castShadows = False
							densityFactor = 1
							maxCache = 512
							maxCacheDelta = 32
							maxLevelOffset = 0
							maxScale = 2.5
							maxScatter = 20
							maxSpeed = 1000
							minScale = 0.15
							recieveShadows = False
							name = Rock00
							seed = 231123
							verticalOffset = 0
							delete = False
							collide = False
							science = False
							Material
							{
								color = 0.679104447,0.679104447,0.679104447,1
								mainTex = BUILTIN/lunar cliff face
								mainTexScale = 1,1
								mainTexOffset = 0,0
							}
							Experiment
							{
							}
						}
					}
				}
				VertexColorMap
				{
					map = AlternisKerbolRekerjiggered/PluginData/Duna_Color.png
					enabled	= true
				}
				VertexHeightMap
				{
					map = AlternisKerbolRekerjiggered/PluginData/Duna_Height.png
					deformity = 11000
					enabled = true
				}
				VertexHeightNoiseVertHeight
				{
					name = VHNVH-1
					noiseType = RidgedMultifractal
					deformity = 1700
					seed = 347565
					frequency = 18
					lacunarity = 1.5
					persistance = 0.7
					octaves = 6
					mode = Low
					heightStart = 0.2
					heightEnd = 1
					order = 20
				}
				VertexSimplexHeightAbsolute
				{
					name = VSHA-1
					seed = 98580
					deformity = 200
					octaves = 8
					persistence = 0.6
					frequency = 24
					order = 22
				}
				VertexSimplexHeightAbsolute
				{
					name = VSHA-2
					seed = 8958758
					deformity = 500
					octaves = 4
					persistence = 0.6
					frequency = 16
					order = 9999993
				}
				VertexHeightNoiseVertHeight
				{
					name = VHNVH-2
					noiseType = RidgedMultifractal
					deformity = 40
					seed = 42634
					frequency = 320
					lacunarity = 1.5
					persistance = 0.7
					octaves = 4
					mode = Low
					heightStart = 0.2
					heightEnd = 1
					order = 20
					
				}
			}
		}
		@Orbit
		{
			@referenceBody = Tylo
			semiMajorAxis = 34598850
			inclination	= 0.7
			eccentricity = 0.05
			longitudeOfAscendingNode = 135.5
			argumentOfPeriapsis	= 0
			meanAnomalyAtEpoch = 3.14
			epoch = 0
			color = RGBA(255, 185, 123, 255)
		}
    }
}

@Kopernicus:FOR[AlternisKerbol]:NEEDS[GalacticNeighborhood]
{
	@Body[Duna]
	{
		@Properties
		{
			%description = Egar is a medium-sized moon orbiting Stumbos. It is colored a nice butterscotch color. It may very well hold life on its surface somewhere, because there's definitely some canalis. Maybe. It looks decently canal-like for sure. Hard to tell at this distance.
		}
	}
}
